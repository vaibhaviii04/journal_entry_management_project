<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard</title>
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
<style>
html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    font-family: 'Poppins', sans-serif;
    background: linear-gradient(to right, #2d2821, #8f7455);
    overflow: hidden;
}

/* ===================== Dashboard Layout ===================== */
.dashboard-container {
    width: 100%;
    height: 100vh;
    display: flex;
    flex-direction: row;
    position: relative;
}

/* ===================== Left Sidebar ===================== */
.left-sidebar {
    width: 200px;
    background: rgba(255,255,255,0.05);
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px 10px;
    color: #f7f3ee;
    border-right: 1px solid rgba(255,255,255,0.1);
}

.left-sidebar h3 {
    margin-top: 0;
    font-size: 16px;
    text-align: center;
}

.quote {
    font-size: 14px;
    font-style: italic;
    margin: 20px 0;
    text-align: center;
}

/* ===================== Main Content ===================== */
.main-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center; 
    justify-content: flex-start;
    position: relative;
}

/* ===================== Welcome Text ===================== */
.welcome-text {
    margin-top: 40px;
    font-size: 30px;
    font-weight: 600;
    color: #f7f3ee;
    text-shadow: 1px 1px 4px #2d2821;
    text-align: center;
    z-index: 3;
}

/* ===================== Search Bar ===================== */
.search-bar-container {
    margin-top: 35px;
    display: flex;
    justify-content: center;
    width: 100%;
}

.search-bar-container form {
    display: flex;
    flex-direction: column;
    align-items: center;
    background: rgba(0,0,0,0.3);
    padding: 20px 25px;
    border-radius: 20px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.3);
}

.search-bar-container input[type="text"] {
    width: 280px;
    padding: 10px 14px;
    border: 1px solid #debba1;
    border-radius: 8px;
    font-size: 14px;
    outline: none;
    background: #f7f3ee;
    color: #4e3b2c;
    transition: all 0.3s ease;
    margin-bottom: 10px;
}

.search-bar-container input[type="text"]:focus {
    border-color: #e8d8b8;
}

.search-bar-container button {
    width: 45px;
    height: 40px;
    border-radius: 8px;
    border: 1px solid #debba1;
    background: #f7f3ee;
    color: #4e3b2c;
    font-size: 16px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
}

.search-bar-container button:hover {
    background: #e8e2d8;
}

/* ===================== Top-right options ===================== */
.top-right-options {
    position: absolute;
    top: 20px;
    right: 20px;
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.top-right-options a {
    display: inline-block;
    padding: 8px 14px;
    font-size: 15px;
    border-radius: 8px;
    border: 1px solid #debba1;
    background: #f7f3ee;
    color: #4e3b2c;
    text-decoration: none;
    text-align: center;
    transition: all 0.2s ease;
}

.top-right-options a:hover {
    background: #e8e2d8;
}

/* Export Journal Button */
.button-export {
    display: inline-block;
    padding: 8px 14px;
    font-size: 15px;
    border-radius: 8px;
    border: 1px solid #debba1;
    background: #f7f3ee;
    color: #4e3b2c;
    text-decoration: none;
    text-align: center;
    transition: background 0.2s ease;
}

.button-export:hover {
    background: #e8e2d8;
}

/* ===================== Add Entry Button ===================== */
.main-action {
    margin-top: 60px;
    display: flex;
    justify-content: center;
}

.main-action a.button-add {
    padding: 20px 45px;
    font-size: 26px;
    border-radius: 12px;
    border: 1px solid #debba1;
    background: #f7f3ee;
    color: #4e3b2c;
    cursor: pointer;
    text-decoration: none;
    transition: all 0.2s ease;
}

.main-action a.button-add:hover {
    transform: scale(1.05);
    background: #e8e2d8;
}

/* ===================== Logout Button ===================== */
.bottom-right-logout {
    position: fixed;
    bottom: 20px;
    right: 20px;
    z-index: 999;
    display: flex;
    justify-content: flex-end;
}

.bottom-right-logout form {
    margin: 0;
}

.bottom-right-logout form button {
    display: inline-block;
    padding: 8px 14px;
    font-size: 15px;
    border-radius: 8px;
    border: 1px solid #debba1;
    background: #f7f3ee;
    color: #4e3b2c;
    cursor: pointer;
    text-align: center;
    transition: all 0.2s ease;
    min-width: 90px;
}

.bottom-right-logout form button:hover {
    background: #e8e2d8;
}

/* ===================== Dashboard Notifications (Left Sidebar) ===================== */
.recent-notifications {
    position: absolute;
    top: 110px; /* under the quote */
    left: 10px; 
    width: 180px;
    background: rgba(255,255,255,0.08);
    border-radius: 12px;
    padding: 10px 10px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.2);
    color: #f7f3ee;
    text-align: left;
    font-size: 13px;
}

.recent-notifications ul {
    list-style: none;
    padding: 0;
    margin: 5px 0 5px 0;
}

.recent-notifications li {
    margin-bottom: 6px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.recent-notifications h3 {
    margin: 0 0 5px 0;
    font-size: 14px;
}

.recent-notifications a.view-all {
    display: block;
    margin-top: 5px;
    font-size: 12px;
    color: #f7f3ee;
    text-decoration: underline;
}
</style>
</head>
<body>

<div class="dashboard-container">
  <div class="left-sidebar">
    <h3>‚ú® Today</h3>
    <div class="quote">"let your words breathe! üíõ"</div>

    <!-- Dashboard Notifications -->
    <div class="recent-notifications">
      <h3>üîî Notifications</h3>
      {% if notifications %}
        <ul>
          {% for n in notifications[:5] %}
            <li title="{{ n.message }}">{{ n.message[:60] }}{% if n.message|length > 60 %}‚Ä¶{% endif %}</li>
          {% endfor %}
        </ul>
        <a href="{{ url_for('notifications', username=username) }}" class="view-all">View All ‚Üí</a>
      {% else %}
        <p>No new notifications.</p>
      {% endif %}
    </div>
  </div>

  <div class="main-content">
    <div class="top-right-options">
      <a href="{{ url_for('view_journal', username=username) }}">üìñ View Entries</a>
      <a href="{{ url_for('settings', username=username) }}">‚öôÔ∏è Settings</a>
      <a href="{{ url_for('reminders', username=username) }}">‚è∞ Reminders</a>
      <a href="{{ url_for('profile', username=username) }}">üë§ Profile</a>
      <a href="{{ url_for('calendar', username=username) }}">üìÖ Calendar</a>
      <a href="{{ url_for('export_journal') }}" class="button-export">üìÑ Export Journal</a>
    </div>

    <div class="welcome-text" id="welcome-text"></div>

    <!-- Search Bar -->
    <div class="search-bar-container">
      <form action="{{ url_for('search_journal', username=username) }}" method="GET">
        <input type="text" name="query" placeholder="Search your journal..." required>
        <button type="submit">üîç</button>
      </form>
    </div>

    <!-- Add Entry Button -->
    <div class="main-action">
      <a href="{{ url_for('add_journal_page', username=username) }}" class="button-add">‚ûï Add Entry ‚úçÔ∏è</a>
    </div>

    <!-- Logout Button -->
    <div class="bottom-right-logout">
      <form action="{{ url_for('logout') }}" method="POST">
        <button type="submit">üö™ Logout</button>
      </form>
    </div>
  </div>
</div>

<script>
  const now = new Date();
  const hour = now.getHours();
  let greeting, emoji;

  if(hour >= 5 && hour < 12) {
      greeting = "Good morning";
      emoji = "üåû";
  } else if(hour >= 12 && hour < 17) {
      greeting = "Good afternoon";
      emoji = "üå§Ô∏è";
  } else if(hour >= 17 && hour < 21) {
      greeting = "Good evening";
      emoji = "üåá";
  } else {
      greeting = "Good night";
      emoji = "üåô";
  }

  const username = "{{ username }}";
  document.getElementById("welcome-text").innerText = `${emoji} ${greeting}, ${username}! ${emoji}`;
</script>

</body>
</html>